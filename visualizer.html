<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starship Entropy | Orbital Dynamics</title>
    <!-- Proven Script Configuration (Iframe Safe) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.js"></script>
    <style>
        @keyframes spin-slow {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .animate-spin-slow {
            animation: spin-slow 8s linear infinite;
        }

        body,
        html,
        #root {
            height: 100%;
            margin: 0;
            background: #020617;
            /* slate-950 */
            color: #fff;
        }

        #fallback-check {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: monospace;
            font-size: 10px;
            color: #475569;
            pointer-events: none;
        }
    </style>
</head>

<body class="bg-slate-950">
    <div id="fallback-check">INITIALIZING ENTROPY ENGINE...</div>
    <div id="root"></div>

    <script type="text/babel" data-presets="react">
        const { useState, useEffect, useRef } = React;
        const {
            Activity,
            Thermometer,
            RefreshCw,
            BarChart3,
            Layers,
            Zap,
            ShieldAlert,
            Info
        } = LucideReact;

        // --- Compact 3D Entropy Curve ---
        const EntropyCanvas = ({ launchFrequency, materialStress }) => {
            const canvasRef = useRef(null);

            useEffect(() => {
                const canvas = canvasRef.current;
                const ctx = canvas.getContext('2d');
                let animationFrame;

                const draw = () => {
                    const w = canvas.width;
                    const h = canvas.height;
                    ctx.clearRect(0, 0, w, h);

                    // Draw Grid
                    ctx.strokeStyle = '#1e293b';
                    ctx.lineWidth = 1;
                    for (let i = 0; i < 10; i++) {
                        ctx.beginPath();
                        ctx.moveTo(i * (w / 10), 0); ctx.lineTo(i * (w / 10), h); ctx.stroke();
                        ctx.beginPath();
                        ctx.moveTo(0, i * (h / 10)); ctx.lineTo(w, i * (h / 10)); ctx.stroke();
                    }

                    // Draw Curve
                    ctx.beginPath();
                    ctx.lineWidth = 3;
                    const gradient = ctx.createLinearGradient(0, h, w, 0);
                    gradient.addColorStop(0, '#3b82f6');
                    gradient.addColorStop(0.6, '#f97316');
                    gradient.addColorStop(1, '#ef4444');
                    ctx.strokeStyle = gradient;

                    ctx.moveTo(0, h * 0.85);
                    const segments = 100;
                    for (let i = 0; i <= segments; i++) {
                        const x = (i / segments) * w;
                        const freqFactor = launchFrequency / 50;
                        const stressFactor = materialStress / 50;
                        const noise = Math.sin(i * 0.2 + Date.now() * 0.002) * 4;
                        const y = (h * 0.85) - (Math.pow(i / segments, 2) * (h * 0.75) * freqFactor * stressFactor) + noise;
                        ctx.lineTo(x, y);
                    }
                    ctx.stroke();

                    animationFrame = requestAnimationFrame(draw);
                };

                draw();
                return () => cancelAnimationFrame(animationFrame);
            }, [launchFrequency, materialStress]);

            return (
                <div className="relative w-full h-40 bg-slate-950 rounded-lg overflow-hidden border border-slate-800 shadow-inner">
                    <canvas ref={canvasRef} width={800} height={200} className="w-full h-full opacity-70" />
                    <div className="absolute top-2 left-3 flex flex-col pointer-events-none">
                        <span className="text-[8px] font-mono text-slate-500 uppercase tracking-widest">Decay Vector</span>
                        <span className="text-orange-500 font-bold text-[10px]">LIVE MODEL</span>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [launchFreq, setLaunchFreq] = useState(65);
            const [materialStress, setMaterialStress] = useState(40);
            const [viewMode, setViewMode] = useState('reusable');

            const efficiencyGain = 40;
            const baselineInventory = 100;
            const reusableInventory = 60;
            const currentInventory = viewMode === 'reusable' ? reusableInventory : baselineInventory;
            const entropyIndex = (launchFreq * materialStress / 100).toFixed(2);

            // Clear fallback on mount
            useEffect(() => {
                const fallback = document.getElementById('fallback-check');
                if (fallback) fallback.style.display = 'none';
            }, []);

            return (
                <div className="h-full min-h-screen w-full bg-slate-950 text-slate-100 font-sans p-4 flex flex-col overflow-hidden">
                    {/* Tight Header */}
                    <header className="flex justify-between items-center mb-4 pb-2 border-b border-slate-800 shrink-0">
                        <div className="flex items-center gap-3">
                            <div className="w-2 h-2 bg-orange-500 rounded-full animate-pulse" />
                            <h1 className="text-xl font-black tracking-tighter uppercase italic">Starship Entropy</h1>
                            <span className="text-[10px] bg-slate-800 px-2 py-0.5 rounded text-slate-400 font-mono">v4.0.2</span>
                        </div>
                        <div className="flex gap-4">
                            <div className="flex items-center gap-2">
                                <Activity className="text-blue-400 w-4 h-4" />
                                <span className="text-[10px] text-slate-500 uppercase">Entropy:</span>
                                <span className="font-mono font-bold text-sm text-blue-400">{entropyIndex}</span>
                            </div>
                            <div className="flex items-center gap-2 border-l border-slate-800 pl-4">
                                <Zap className="text-orange-400 w-4 h-4" />
                                <span className="text-[10px] text-slate-500 uppercase">Gain:</span>
                                <span className="font-mono font-bold text-sm text-orange-400">+{efficiencyGain}%</span>
                            </div>
                        </div>
                    </header>

                    <main className="flex-grow grid grid-cols-12 gap-4 overflow-hidden min-h-0">
                        {/* Left Column - Controls & Logistics */}
                        <section className="col-span-4 flex flex-col gap-4 overflow-hidden">
                            <div className="bg-slate-900/50 p-4 rounded-xl border border-slate-800">
                                <h2 className="text-[10px] font-bold text-slate-500 uppercase mb-4 flex items-center gap-2">
                                    Parameters
                                </h2>
                                <div className="space-y-5">
                                    <div>
                                        <div className="flex justify-between mb-1">
                                            <label className="text-[11px] font-semibold text-slate-400 tracking-wide">Frequency</label>
                                            <span className="text-blue-400 font-mono text-[11px]">{launchFreq} Hz</span>
                                        </div>
                                        <input
                                            type="range" min="1" max="100" value={launchFreq}
                                            onChange={(e) => setLaunchFreq(parseInt(e.target.value))}
                                            className="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-blue-500"
                                        />
                                    </div>
                                    <div>
                                        <div className="flex justify-between mb-1">
                                            <label className="text-[11px] font-semibold text-slate-400 tracking-wide">Stress</label>
                                            <span className="text-orange-400 font-mono text-[11px]">{materialStress} MPa</span>
                                        </div>
                                        <input
                                            type="range" min="1" max="100" value={materialStress}
                                            onChange={(e) => setMaterialStress(parseInt(e.target.value))}
                                            className="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-orange-500"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* Logistics */}
                            <div className="bg-slate-900/50 p-4 rounded-xl border border-slate-800 flex-grow flex flex-col">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-2">
                                        Forecast
                                    </h2>
                                    <button
                                        onClick={() => setViewMode(v => v === 'reusable' ? 'baseline' : 'reusable')}
                                        className={`text-[9px] px-2 py-1 rounded border transition-all uppercase font-bold ${viewMode === 'reusable' ? 'bg-blue-500/10 border-blue-500/50 text-blue-300' : 'bg-slate-800 border-slate-700 text-slate-500'
                                            }`}
                                    >
                                        {viewMode === 'reusable' ? 'Reusable' : 'Baseline'}
                                    </button>
                                </div>
                                <div className="flex items-end gap-3 h-20 mb-4 px-4 mt-auto">
                                    <div className="flex-1 flex flex-col items-center gap-1 h-full">
                                        <div className="w-full bg-slate-800 rounded-t h-full" />
                                        <span className="text-[8px] text-slate-600">BSL</span>
                                    </div>
                                    <div className="flex-1 flex flex-col items-center gap-1 h-full justify-end">
                                        <div
                                            className={`w-full rounded-t transition-all duration-500 ${viewMode === 'reusable' ? 'bg-orange-500' : 'bg-slate-800'}`}
                                            style={{ height: `${viewMode === 'reusable' ? reusableInventory : baselineInventory}%` }}
                                        />
                                        <span className={`text-[8px] ${viewMode === 'reusable' ? 'text-orange-400' : 'text-slate-600'}`}>REU</span>
                                    </div>
                                </div>
                                <p className="text-[10px] text-slate-500 text-center font-mono">
                                    REQ: <span className="text-slate-100">{currentInventory} units</span>
                                </p>
                            </div>

                            <div className="bg-orange-500/5 border border-orange-500/20 p-3 rounded-lg flex gap-3 items-center">
                                <ShieldAlert className="w-4 h-4 text-orange-500 shrink-0" />
                                <p className="text-[9px] text-orange-200/50 leading-tight">Shielding integrity at 98.4% nominal.</p>
                            </div>
                        </section>

                        {/* Right Column - Visualizer & Telemetry */}
                        <section className="col-span-8 flex flex-col gap-4 overflow-hidden">
                            <div className="bg-slate-900/50 p-5 rounded-xl border border-slate-800 flex flex-col h-full overflow-hidden">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-xs font-black text-white uppercase italic tracking-tighter">Entropy Field Visualization</h2>
                                    <div className="flex items-center gap-2 text-slate-600 text-[9px] font-mono">
                                        <RefreshCw className="w-2.5 h-2.5 animate-spin-slow" /> LIVE_STREAM
                                    </div>
                                </div>

                                <EntropyCanvas launchFrequency={launchFreq} materialStress={materialStress} />

                                <div className="grid grid-cols-3 gap-4 mt-6">
                                    <div className="p-3 bg-slate-950/50 rounded-lg border border-slate-800">
                                        <div className="flex items-center gap-1.5 mb-2 text-slate-500">
                                            <Thermometer className="w-3.5 h-3.5 text-orange-500" />
                                            <span className="text-[9px] font-bold uppercase">Thermal</span>
                                        </div>
                                        <p className="text-lg font-mono text-white">{(materialStress * 1.45).toFixed(1)}°K</p>
                                        <div className="mt-2 w-full bg-slate-900 h-1 rounded-full overflow-hidden">
                                            <div className="bg-orange-500 h-full transition-all duration-500" style={{ width: `${materialStress}%` }} />
                                        </div>
                                    </div>

                                    <div className="p-3 bg-slate-950/50 rounded-lg border border-slate-800">
                                        <div className="flex items-center gap-1.5 mb-2 text-slate-500">
                                            <RefreshCw className="w-3.5 h-3.5 text-blue-500" />
                                            <span className="text-[9px] font-bold uppercase">Latency</span>
                                        </div>
                                        <p className="text-lg font-mono text-white">{(120 / (launchFreq / 10 || 1)).toFixed(1)}h</p>
                                        <div className="mt-2 w-full bg-slate-900 h-1 rounded-full overflow-hidden">
                                            <div className="bg-blue-500 h-full transition-all duration-500" style={{ width: `${100 - launchFreq}%` }} />
                                        </div>
                                    </div>

                                    <div className="p-3 bg-slate-950/50 rounded-lg border border-slate-800">
                                        <div className="flex items-center gap-1.5 mb-2 text-slate-500">
                                            <Info className="w-3.5 h-3.5 text-green-500" />
                                            <span className="text-[9px] font-bold uppercase">Lifecycle</span>
                                        </div>
                                        <p className="text-lg font-mono text-white">{Math.max(1, Math.floor(25 - (entropyIndex / 2)))} CYC</p>
                                        <div className="mt-2 w-full bg-slate-900 h-1 rounded-full overflow-hidden">
                                            <div className="bg-green-500 h-full transition-all duration-500" style={{ width: `${Math.max(0, 100 - entropyIndex)}%` }} />
                                        </div>
                                    </div>
                                </div>

                                <div className="mt-auto pt-4 flex gap-3">
                                    <button className="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-black py-3 rounded-lg transition-all uppercase tracking-tighter italic text-xs active:scale-95">
                                        Export Data
                                    </button>
                                    <button className="flex-1 border border-slate-800 hover:bg-slate-800 text-slate-400 font-black py-3 rounded-lg transition-all uppercase tracking-tighter italic text-xs active:scale-95">
                                        Calibration
                                    </button>
                                </div>
                            </div>
                        </section>
                    </main>

                    {/* Footer */}
                    <footer className="mt-4 flex justify-between items-center text-slate-600 text-[8px] font-mono tracking-widest uppercase shrink-0">
                        <span>© 2026 Orbital Dynamics</span>
                        <div className="flex gap-4">
                            <span>Security: LVL 5</span>
                            <span>Status: Nominal</span>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>